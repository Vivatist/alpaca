# PPTX Parser - –ò—Ç–æ–≥–æ–≤–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## ‚úÖ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

–°–æ–∑–¥–∞–Ω –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –ø–∞—Ä—Å–µ—Ä PowerPoint –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–π (.pptx) –¥–ª—è —Å–∏—Å—Ç–µ–º—ã ALPACA —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ä—É—Å—Å–∫–æ–≥–æ –∏ –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ —è–∑—ã–∫–æ–≤.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
document-processors/src/parsers/pptx/
‚îú‚îÄ‚îÄ __init__.py           # –≠–∫—Å–ø–æ—Ä—Ç PptxParser
‚îú‚îÄ‚îÄ pptx_parser.py        # –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –ø–∞—Ä—Å–µ—Ä–∞ (325+ —Å—Ç—Ä–æ–∫)
‚îú‚îÄ‚îÄ README.md             # –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ QUICKSTART.md         # –ö—Ä–∞—Ç–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
‚îî‚îÄ‚îÄ INSTALL.md            # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ

tests/
‚îî‚îÄ‚îÄ test_pptx_parser.py   # –ú–æ–¥—É–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã

document-processors/requirements.txt
‚îî‚îÄ‚îÄ python-pptx>=0.6.21   # –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å
```

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è:
- **–¢–µ–∫—Å—Ç –∏–∑ —Å–ª–∞–π–¥–æ–≤**: –∑–∞–≥–æ–ª–æ–≤–∫–∏, –∞–±–∑–∞—Ü—ã, —Å–ø–∏—Å–∫–∏
- **–¢–∞–±–ª–∏—Ü—ã**: –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ Markdown —Ñ–æ—Ä–º–∞—Ç
- **–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ**: –∞–≤—Ç–æ—Ä, –Ω–∞–∑–≤–∞–Ω–∏–µ, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–∞–π–¥–æ–≤
- **–Ø–∑—ã–∫–∏**: —Ä—É—Å—Å–∫–∏–π –∏ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π (—á–µ—Ä–µ–∑ unstructured)
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∞**: —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–µ—Ä–∞—Ä—Ö–∏–∏ —Å–ª–∞–π–¥–æ–≤
- **YAML header**: –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–ª—è RAG –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏
- **Fallback parser**: —Ä–µ–∑–µ—Ä–≤–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ —á–µ—Ä–µ–∑ python-pptx

### ‚ùå –ù–ï –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è (–ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é):
- OCR –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- SmartArt –¥–∏–∞–≥—Ä–∞–º–º—ã (—Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç)
- –°—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç .ppt (—Ç–æ–ª—å–∫–æ .pptx)
- –ê–Ω–∏–º–∞—Ü–∏–∏ –∏ –ø–µ—Ä–µ—Ö–æ–¥—ã

## üîß –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

### –û—Å–Ω–æ–≤–Ω–æ–π pipeline:
1. **Unstructured** - –ø–∞—Ä—Å–∏–Ω–≥ —Ç–µ–∫—Å—Ç–∞ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞
2. **python-pptx** - –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö + fallback –ø–∞—Ä—Å–∏–Ω–≥
3. **BaseParser** - –æ–±—â–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ + YAML –≥–µ–Ω–µ—Ä–∞—Ü–∏—è

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```python
# –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
python-pptx>=0.6.21

# –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è (–ª—É—á—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ)
unstructured[pptx]
```

## üìù –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```python
from parsers.pptx import PptxParser

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
parser = PptxParser()

# –ü–∞—Ä—Å–∏–Ω–≥ —Ñ–∞–π–ª–∞
result = parser.parse("presentation.pptx", file_hash="abc123")

if result['success']:
    print(f"‚úì Slides: {result['metadata']['slides']}")
    print(f"‚úì Author: {result['metadata']['author']}")
    print(f"‚úì Text: {len(result['markdown'])} chars")
    
    # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ Markdown
    parser.save_to_markdown_file(result, "output.md")
else:
    print(f"‚úó Error: {result['error']}")
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ë–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã (–±–µ–∑ —Ñ–∞–π–ª–æ–≤)
python tests/test_pptx_parser.py

# ‚úì Parser initialized
# ‚úì Parser has 'parse' method
# ‚úì Parser returns correct structure
# ‚úì Parser handles missing files correctly
# All tests passed!

# –¢–µ—Å—Ç —Å —Ä–µ–∞–ª—å–Ω—ã–º —Ñ–∞–π–ª–æ–º
python tests/test_pptx_parser.py --file sample.pptx
```

## üìä –§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞

### Markdown —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:
```markdown
---
document_type: pptx
parsed_date: 2025-10-28T12:00:00Z
parser: alpaca-pptx-parser
file_name: presentation.pptx
author: –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤
slides: 10
ocr_enabled: false
---

## –°–ª–∞–π–¥ 1

### –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø–µ—Ä–≤–æ–≥–æ —Å–ª–∞–π–¥–∞

–¢–µ–∫—Å—Ç —Å–ª–∞–π–¥–∞...

---

## –°–ª–∞–π–¥ 2

### –¢–∞–±–ª–∏—Ü–∞ –¥–∞–Ω–Ω—ã—Ö

| –ö–æ–ª–æ–Ω–∫–∞ 1 | –ö–æ–ª–æ–Ω–∫–∞ 2 |
|---|---|
| –î–∞–Ω–Ω—ã–µ 1 | –î–∞–Ω–Ω—ã–µ 2 |

---
```

### –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ:
```python
{
    # –û–±—â–∏–µ (–æ—Ç BaseParser)
    'file_name': 'presentation.pptx',
    'file_path': '/path/to/file.pptx',
    'file_hash': '1730123456-204800',
    'file_size': 204800,
    'file_modified': '2025-10-28T12:00:00',
    'file_created': '2025-10-27T10:00:00',
    
    # –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–ª—è PPTX
    'author': '–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤',
    'title': '–û—Ç—á–µ—Ç –ø–æ –ø—Ä–æ–µ–∫—Ç—É',
    'subject': '–†–µ–∑—É–ª—å—Ç–∞—Ç—ã',
    'slides': 10,
    'ocr_enabled': False
}
```

## üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å ALPACA

### –° file-watcher:
```python
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ .pptx —Ñ–∞–π–ª–æ–≤
from parsers.pptx import PptxParser

parser = PptxParser()
result = parser.parse(file_path, file_hash=watcher_hash)

# –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Dify RAG
dify_client.upload_document(
    content=result['yaml_header'] + result['markdown'],
    metadata=result['metadata']
)
```

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:
```
[File System]
    ‚Üì
[File Watcher] - –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ .pptx —Ñ–∞–π–ª–æ–≤
    ‚Üì
[PPTX Parser] - –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ + –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
    ‚Üì
[Dify RAG Engine] - –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è
    ‚Üì
[Web UI] - –ø–æ–∏—Å–∫ –ø–æ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è–º
```

## üìñ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π `alpaca_logger`:

```
2025-10-28 12:00:00 [INFO] pptx-parser: Parsing PowerPoint presentation | file=report.pptx
2025-10-28 12:00:01 [INFO] pptx-parser: PPTX-specific metadata | author=–ò–≤–∞–Ω–æ–≤ –ò.–ò. slides=10 title=–û—Ç—á–µ—Ç
2025-10-28 12:00:02 [INFO] pptx-parser: Unstructured parsing complete | slides=10 text_length=5420
2025-10-28 12:00:03 [INFO] pptx-parser: PowerPoint presentation parsed successfully | file=report.pptx slides=10
```

–õ–æ–≥–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ Grafana: `{service="pptx-parser"}`

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–ü–∞—Ä—Å–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç "–∏–∑ –∫–æ—Ä–æ–±–∫–∏" –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

- **–Ø–∑—ã–∫–∏**: —Ä—É—Å—Å–∫–∏–π + –∞–Ω–≥–ª–∏–π—Å–∫–∏–π (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
- **OCR**: –æ—Ç–∫–ª—é—á–µ–Ω (–ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é)
- **Fallback**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ python-pptx
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: plain text —á–µ—Ä–µ–∑ alpaca_logger

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞:
```bash
cd /c/Users/Andrey/Alpaca
pip install python-pptx>=0.6.21
pip install "unstructured[pptx]"
```

### Docker:
```bash
# –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É–∂–µ –≤ requirements.txt
docker compose build document-processors
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **README.md** - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏
- **QUICKSTART.md** - –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
- **INSTALL.md** - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- **test_pptx_parser.py** - –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

## ‚ú® –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** (–µ—Å–ª–∏ –ª–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞):
   ```bash
   pip install python-pptx>=0.6.21 "unstructured[pptx]"
   ```

2. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å** —Å —Ä–µ–∞–ª—å–Ω—ã–º —Ñ–∞–π–ª–æ–º:
   ```bash
   python tests/test_pptx_parser.py --file your_presentation.pptx
   ```

3. **–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å** —Å file-watcher –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏

4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏** –≤ Grafana –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞

## üéØ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º

‚úÖ **Unstructured** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π –ø–∞—Ä—Å–µ—Ä  
‚úÖ **–†—É—Å—Å–∫–∏–π —è–∑—ã–∫** - –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `languages=["rus", "eng"]`  
‚úÖ **–ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫** - –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è  
‚úÖ **–ë–ï–ó OCR** - –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è  
‚úÖ **–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ** - –ø–æ–ª–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ (–∞–≤—Ç–æ—Ä, —Å–ª–∞–π–¥—ã, etc.)  
‚úÖ **YAML header** - –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –¥–ª—è RAG  
‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - plain text —á–µ—Ä–µ–∑ alpaca_logger  
‚úÖ **–¢–µ—Å—Ç—ã** - –±–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã  
‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - 4 —Ñ–∞–π–ª–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏  

---

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ì–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é  
**–í–µ—Ä—Å–∏—è**: 1.0.0  
**–î–∞—Ç–∞**: 28 –æ–∫—Ç—è–±—Ä—è 2025  
**–ê–≤—Ç–æ—Ä**: ALPACA Team
