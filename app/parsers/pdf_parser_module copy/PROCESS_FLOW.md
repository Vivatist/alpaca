# PDF Parser - Ğ­Ñ‚Ğ°Ğ¿Ñ‹ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²

## ğŸ“Š Ğ¡Ñ…ĞµĞ¼Ğ° Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ° Ğ¿Ğ°Ñ€ÑĞ¸Ğ½Ğ³Ğ° PDF

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Ğ’Ğ¥ĞĞ”ĞĞĞ™ PDF Ğ¤ĞĞ™Ğ›                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ğ­Ğ¢ĞĞŸ 1: Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ Ğ¼ĞµÑ‚Ğ°Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… (pypdf)                          â”‚
â”‚  â€¢ Title, Author, Subject, Creator, Producer                     â”‚
â”‚  â€¢ Ğ”Ğ°Ñ‚Ñ‹ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ/Ğ¼Ğ¾Ğ´Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸ (Ğ¿Ğ°Ñ€ÑĞ¸Ğ½Ğ³ D:YYYYMMDDHHmmSS)        â”‚
â”‚  â€¢ ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†                                            â”‚
â”‚  â€¢ Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ğ­Ğ¢ĞĞŸ 2: ĞĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ñ‚Ğ¸Ğ¿Ğ° Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°                             â”‚
â”‚  â€¢ Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ Ñ‚ĞµĞºÑÑ‚Ğ° Ñ Ğ¿ĞµÑ€Ğ²Ñ‹Ñ… 3 ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†                         â”‚
â”‚  â€¢ ĞŸĞ¾Ğ´ÑÑ‡ĞµÑ‚: avg_chars_per_page < 50 â†’ SCANNED                   â”‚
â”‚  â€¢ Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ: Ğ¢ĞµĞºÑÑ‚Ğ¾Ğ²Ñ‹Ğ¹ PDF Ğ¸Ğ»Ğ¸ ĞÑ‚ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚                       â”‚
           â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Ğ¢Ğ•ĞšĞ¡Ğ¢ĞĞ’Ğ«Ğ™ PDF      â”‚  â”‚     ĞĞ¢Ğ¡ĞšĞĞĞ˜Ğ ĞĞ’ĞĞĞĞ«Ğ™ PDF               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                           â”‚
           â–¼                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ğ­Ğ¢ĞĞŸ 3A: ĞŸĞ°Ñ€ÑĞ¸Ğ½Ğ³ Ñ‚ĞµĞºÑÑ‚Ğ°          Ğ­Ğ¢ĞĞŸ 3B: OCR Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°        â”‚
â”‚  â€¢ Markitdown (Ğ¿Ñ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚)         â€¢ Unstructured partition_pdf  â”‚
â”‚  â€¢ Fallback: pypdf                â€¢ strategy=auto/hi_res/fast   â”‚
â”‚  â€¢ Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñ‹           â€¢ languages=[rus, eng]        â”‚
â”‚                                    â€¢ infer_table_structure=True  â”‚
â”‚                                    â€¢ extract_images_in_pdf=True  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚                     â”‚
                       â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚      â”‚
                       â–¼      â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ°: len(text) < 100 â”‚
            â”‚  Ğ”Ğ â†’ Ğ—Ğ°Ğ¿ÑƒÑĞº OCR Ğ´Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚. â”‚
            â”‚  Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ğ±Ğ¾Ğ»ĞµĞµ Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ğ³Ğ¾ Ñ‚ĞµĞºÑÑ‚Ğ°â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ğ­Ğ¢ĞĞŸ 4: Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ YAML Header                                  â”‚
â”‚  ---                                                             â”‚
â”‚  document_type: pdf                                              â”‚
â”‚  file_name: Ğ”Ğ¾Ğ³Ğ¾Ğ²Ğ¾Ñ€_123.pdf                                      â”‚
â”‚  parsed_date: 2025-10-28T14:30:00Z                              â”‚
â”‚  parser: alpaca-pdf-parser                                       â”‚
â”‚  title: "Ğ”Ğ¾Ğ³Ğ¾Ğ²Ğ¾Ñ€ Ğ¿Ğ¾ÑÑ‚Ğ°Ğ²ĞºĞ¸"                                       â”‚
â”‚  author: "ĞĞĞ Ğ“ĞµĞ¾Ñ€ĞµĞ·Ğ¾Ğ½Ğ°Ğ½Ñ"                                       â”‚
â”‚  pages: 25                                                       â”‚
â”‚  ocr_enabled: true                                               â”‚
â”‚  is_scanned: true                                                â”‚
â”‚  ocr_strategy: auto                                              â”‚
â”‚  ---                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ğ­Ğ¢ĞĞŸ 5: Ğ¤Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ğ°Ñ ÑĞ±Ğ¾Ñ€ĞºĞ° Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ°                            â”‚
â”‚  {                                                               â”‚
â”‚    'markdown': '## Ğ¡Ñ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ° 1\n\nĞ¢ĞµĞºÑÑ‚...',                     â”‚
â”‚    'metadata': {...},                                            â”‚
â”‚    'pages_info': [...],                                          â”‚
â”‚    'yaml_header': '---\n...',                                    â”‚
â”‚    'success': True                                               â”‚
â”‚  }                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Ğ¡ĞĞ¥Ğ ĞĞĞ•ĞĞ˜Ğ• Ğ’ MARKDOWN (Celery task)                   â”‚
â”‚  â€¢ Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ¸Ğ¼ĞµĞ½Ğ¸: {timestamp}_{safe_name}.md                  â”‚
â”‚  â€¢ ĞŸÑƒÑ‚ÑŒ: /volume_md/{filename}                                  â”‚
â”‚  â€¢ Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚: YAML Header + Markdown Content                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”‘ ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ¾ÑĞ¾Ğ±ĞµĞ½Ğ½Ğ¾ÑÑ‚Ğ¸

### 1. ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ñ‚Ğ¸Ğ¿Ğ°
ĞŸĞ°Ñ€ÑĞµÑ€ **ÑĞ°Ğ¼Ğ¾ÑÑ‚Ğ¾ÑÑ‚ĞµĞ»ÑŒĞ½Ğ¾** Ñ€ĞµÑˆĞ°ĞµÑ‚ Ğ½ÑƒĞ¶ĞµĞ½ Ğ»Ğ¸ OCR, Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒÑ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ğ¼Ğ¾Ğµ:
- **< 50 ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ²/ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ°** â†’ ĞÑ‚ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ (OCR)
- **â‰¥ 50 ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ²/ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ°** â†’ Ğ¢ĞµĞºÑÑ‚Ğ¾Ğ²Ñ‹Ğ¹ (Markitdown)

### 2. Ğ“Ğ¸Ğ±Ñ€Ğ¸Ğ´Ğ½Ñ‹Ğ¹ Ñ€ĞµĞ¶Ğ¸Ğ¼
Ğ•ÑĞ»Ğ¸ Ñ‚ĞµĞºÑÑ‚Ğ¾Ğ²Ğ¾Ğ³Ğ¾ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚Ğ° Ğ¼Ğ°Ğ»Ğ¾ (`len < 100`), Ğ¿Ğ°Ñ€ÑĞµÑ€ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ OCR **Ğ´Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾** Ğ¸ Ğ²Ñ‹Ğ±Ğ¸Ñ€Ğ°ĞµÑ‚ Ğ»ÑƒÑ‡ÑˆĞ¸Ğ¹ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚.

### 3. ĞŸĞ¾ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ‡Ğ½Ğ°Ñ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ°
Ğ’ĞµÑÑŒ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½ Ğ¿Ğ¾ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ°Ğ¼ Ğ´Ğ»Ñ Ñ‚Ğ¾Ñ‡Ğ½Ğ¾Ğ¹ Ñ‚Ñ€Ğ°ÑÑĞ¸Ñ€Ğ¾Ğ²ĞºĞ¸ Ğ¸ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸ĞºĞ¾Ğ² Ğ² RAG:
```markdown
## Ğ¡Ñ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ° 1
Ğ¡Ğ¾Ğ´ĞµÑ€Ğ¶Ğ°Ğ½Ğ¸Ğµ Ğ¿ĞµÑ€Ğ²Ğ¾Ğ¹ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ñ‹...

## Ğ¡Ñ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ° 2
Ğ¡Ğ¾Ğ´ĞµÑ€Ğ¶Ğ°Ğ½Ğ¸Ğµ Ğ²Ñ‚Ğ¾Ñ€Ğ¾Ğ¹ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ñ‹...
```

### 4. ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ° Ñ€ÑƒÑÑĞºĞ¾Ğ³Ğ¾ ÑĞ·Ñ‹ĞºĞ°
**ĞšĞ Ğ˜Ğ¢Ğ˜Ğ§ĞĞ**: `languages=["rus", "eng"]` Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ Ğ´Ğ»Ñ OCR, Ñ‚.Ğº. ĞºĞ¾Ğ½Ñ‚Ñ€Ğ°ĞºÑ‚Ñ‹ ĞĞĞ "Ğ“ĞµĞ¾Ñ€ĞµĞ·Ğ¾Ğ½Ğ°Ğ½Ñ" Ğ½Ğ° Ñ€ÑƒÑÑĞºĞ¾Ğ¼.

### 5. Graceful Degradation
ĞšĞ°Ğ¶Ğ´Ñ‹Ğ¹ ÑÑ‚Ğ°Ğ¿ Ğ¸Ğ¼ĞµĞµÑ‚ fallback ÑÑ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ñ Ğ¿Ñ€Ğ¸ Ğ¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ğ²Ğ¸Ğ¸ Ğ±Ğ¸Ğ±Ğ»Ğ¸Ğ¾Ñ‚ĞµĞº.

## ğŸ“¦ Ğ—Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ vs Word Parser

| Ğ‘Ğ¸Ğ±Ğ»Ğ¸Ğ¾Ñ‚ĞµĞºĞ° | PDF Parser | Word Parser |
|------------|------------|-------------|
| ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ Ğ¿Ğ°Ñ€ÑĞµÑ€ | `markitdown` | `markitdown` |
| ĞœĞµÑ‚Ğ°Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ | `pypdf` | `python-docx` |
| OCR Ğ´Ğ²Ğ¸Ğ¶Ğ¾Ğº | `unstructured.partition_pdf` | `unstructured.partition_image` |
| Ğ”Ğ¾Ğ¿. Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ñ‹ | `pdf2image` | `PIL`, LibreOffice |
| ĞšĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ°Ñ†Ğ¸Ñ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ° | âŒ ĞĞµ Ñ‚Ñ€ĞµĞ±ÑƒĞµÑ‚ÑÑ | âœ… .doc â†’ .docx |

## ğŸ¯ Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ²

### PDF: 5 ÑÑ‚Ğ°Ğ¿Ğ¾Ğ²
1. ĞœĞµÑ‚Ğ°Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ (pypdf)
2. ĞĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ñ‚Ğ¸Ğ¿Ğ° (Ñ‚ĞµĞºÑÑ‚ vs ÑĞºĞ°Ğ½)
3. ĞŸĞ°Ñ€ÑĞ¸Ğ½Ğ³ (Markitdown Ğ¸Ğ»Ğ¸ OCR)
4. YAML header
5. Ğ¡Ğ±Ğ¾Ñ€ĞºĞ° Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ°

### Word: 7 ÑÑ‚Ğ°Ğ¿Ğ¾Ğ²
1. ĞšĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ°Ñ†Ğ¸Ñ .doc â†’ .docx (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾)
2. ĞœĞµÑ‚Ğ°Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ (python-docx)
3. Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğ¹
4. ĞŸĞ°Ñ€ÑĞ¸Ğ½Ğ³ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñ‹ (Markitdown)
5. OCR Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğ¹
6. YAML header
7. Ğ¡Ğ±Ğ¾Ñ€ĞºĞ° + Ğ¾Ñ‡Ğ¸ÑÑ‚ĞºĞ°

## ğŸš€ ĞŸÑ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ

### Ğ¢ĞµĞºÑÑ‚Ğ¾Ğ²Ñ‹Ğ¹ PDF (Ğ±ĞµĞ· OCR)
- **Ğ¡ĞºĞ¾Ñ€Ğ¾ÑÑ‚ÑŒ**: ~0.5-2 ÑĞµĞºÑƒĞ½Ğ´Ñ‹ Ğ½Ğ° Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚
- **Ğ¡Ñ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ñ**: Markitdown â†’ Ğ¿Ñ€ÑĞ¼Ğ¾Ğµ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ Ñ‚ĞµĞºÑÑ‚Ğ°
- **Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ CPU**: ĞĞ¸Ğ·ĞºĞ¾Ğµ

### ĞÑ‚ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ PDF (Ñ OCR)
- **Ğ¡ĞºĞ¾Ñ€Ğ¾ÑÑ‚ÑŒ**: ~3-10 ÑĞµĞºÑƒĞ½Ğ´/ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ° (Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ñ‚ Ğ¾Ñ‚ strategy)
- **Ğ¡Ñ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ñ**: Unstructured OCR Ñ Tesseract
- **Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ CPU**: Ğ’Ñ‹ÑĞ¾ĞºĞ¾Ğµ

### Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ğ¸ Ğ¿Ğ¾ OCR ÑÑ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸ÑĞ¼
- **`auto`** - Ğ´Ğ»Ñ production (Ğ±Ğ°Ğ»Ğ°Ğ½Ñ ÑĞºĞ¾Ñ€Ğ¾ÑÑ‚Ğ¸ Ğ¸ ĞºĞ°Ñ‡ĞµÑÑ‚Ğ²Ğ°)
- **`fast`** - Ğ´Ğ»Ñ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ (Ğ¼Ğ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ OCR)
- **`hi_res`** - Ğ´Ğ»Ñ Ğ²Ğ°Ğ¶Ğ½Ñ‹Ñ… Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ² (Ğ¼Ğ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ñ‚Ğ¾Ñ‡Ğ½Ğ¾ÑÑ‚ÑŒ)
- **`ocr_only`** - Ğ´Ğ»Ñ Ñ‡Ğ¸ÑÑ‚Ñ‹Ñ… ÑĞºĞ°Ğ½Ğ¾Ğ² (Ğ¸Ğ³Ğ½Ğ¾Ñ€Ğ¸Ñ€ÑƒĞµÑ‚ Ñ‚ĞµĞºÑÑ‚Ğ¾Ğ²Ñ‹Ğ¹ ÑĞ»Ğ¾Ğ¹)

## ğŸ’¡ Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ² Celery

```python
# Ğ’ pdf_tasks.py
from parsers.pdf.pdf_parser import PDFParser

pdf_parser = PDFParser(enable_ocr=True, ocr_strategy='auto')

@app.task(bind=True)
def process_pdf_file(self, file_path: str, message: Dict) -> Dict:
    # ĞŸĞ°Ñ€ÑĞ¸Ğ½Ğ³
    parse_result = pdf_parser.parse(file_path)
    
    # Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ markdown
    md_path = f"/volume_md/{timestamp}_{filename}.md"
    pdf_parser.save_to_markdown_file(parse_result, md_path)
    
    return {
        'status': 'success',
        'metadata': parse_result['metadata'],
        'markdown_file': md_path
    }
```

## ğŸ”§ ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ

### Ğ’ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ/Ğ¾Ñ‚ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ OCR
```python
# Ğ‘ĞµĞ· OCR (Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ñ‚ĞµĞºÑÑ‚Ğ¾Ğ²Ñ‹Ğµ PDF)
parser = PDFParser(enable_ocr=False)

# Ğ¡ OCR (Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ)
parser = PDFParser(enable_ocr=True, ocr_strategy='auto')

# ĞœĞ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ ĞºĞ°Ñ‡ĞµÑÑ‚Ğ²Ğ¾ OCR
parser = PDFParser(enable_ocr=True, ocr_strategy='hi_res')
```

### Mock Ñ€ĞµĞ¶Ğ¸Ğ¼ (Ğ´Ğ»Ñ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ)
```yaml
# shared/config/main_config.yaml
document_processors:
  mock_parsers:
    enabled: true  # Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ MockParser Ğ²Ğ¼ĞµÑÑ‚Ğ¾ Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾
```

## ğŸ“ Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğ°

### Markdown Ñ„Ğ°Ğ¹Ğ»
```markdown
---
document_type: pdf
file_name: Ğ”Ğ¾Ğ³Ğ¾Ğ²Ğ¾Ñ€_123.pdf
file_path: /volume_documents/Ğ”Ğ¾Ğ³Ğ¾Ğ²Ğ¾Ñ€_123.pdf
parsed_date: 2025-10-28T14:30:00Z
parser: alpaca-pdf-parser
title: "Ğ”Ğ¾Ğ³Ğ¾Ğ²Ğ¾Ñ€ Ğ¿Ğ¾ÑÑ‚Ğ°Ğ²ĞºĞ¸ Ğ¾Ğ±Ğ¾Ñ€ÑƒĞ´Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ"
author: "ĞĞĞ Ğ“ĞµĞ¾Ñ€ĞµĞ·Ğ¾Ğ½Ğ°Ğ½Ñ"
pages: 25
encrypted: false
ocr_enabled: true
is_scanned: true
ocr_strategy: auto
---

## Ğ¡Ñ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ° 1

Ğ”ĞĞ“ĞĞ’ĞĞ  ĞŸĞĞ¡Ğ¢ĞĞ’ĞšĞ˜ â„–123
Ğ¾Ñ‚ 15 Ğ¼Ğ°Ñ 2024 Ğ³Ğ¾Ğ´Ğ°

ĞĞ°ÑÑ‚Ğ¾ÑÑ‰Ğ¸Ğ¹ Ğ´Ğ¾Ğ³Ğ¾Ğ²Ğ¾Ñ€ Ğ·Ğ°ĞºĞ»ÑÑ‡ĞµĞ½ Ğ¼ĞµĞ¶Ğ´Ñƒ...

## Ğ¡Ñ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ° 2

1. ĞŸĞ Ğ•Ğ”ĞœĞ•Ğ¢ Ğ”ĞĞ“ĞĞ’ĞĞ Ğ
1.1. ĞŸĞ¾ÑÑ‚Ğ°Ğ²Ñ‰Ğ¸Ğº Ğ¾Ğ±ÑĞ·ÑƒĞµÑ‚ÑÑ...
```

### Celery Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚
```python
{
    'status': 'success',
    'file_name': 'Ğ”Ğ¾Ğ³Ğ¾Ğ²Ğ¾Ñ€_123.pdf',
    'file_type': 'pdf',
    'processing_time_sec': 8.45,
    'markdown_file': '20251028_143000_123_Dogovor_123.md',
    'markdown_length': 15234,
    'metadata': {
        'title': 'Ğ”Ğ¾Ğ³Ğ¾Ğ²Ğ¾Ñ€ Ğ¿Ğ¾ÑÑ‚Ğ°Ğ²ĞºĞ¸ Ğ¾Ğ±Ğ¾Ñ€ÑƒĞ´Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ',
        'author': 'ĞĞĞ Ğ“ĞµĞ¾Ñ€ĞµĞ·Ğ¾Ğ½Ğ°Ğ½Ñ',
        'pages': 25,
        'created': '2024-05-15T10:30:00',
        'encrypted': False
    },
    'ocr_enabled': True,
    'task_id': 'abc123-def456'
}
```
