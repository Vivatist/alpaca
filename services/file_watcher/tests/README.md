# File Watcher Tests

## Модули тестов

### 1. File Filter Tests (7 тестов)
- **test_01**: Фильтрация по минимальному размеру (< 500 байт пропускаются)
- **test_02**: Фильтрация по максимальному размеру (> 10 МБ пропускаются)
- **test_03**: Фильтрация директорий (TMP, temp, cache, скрытые)
- **test_04**: Фильтрация по шаблонам (~*, .*, *.tmp)
- **test_05**: Создание фильтра из переменных окружения
- **test_06**: Комбинированные фильтры (размер + шаблоны)
- **test_07**: Граничные случаи (пустой файл, ровно на границах)

### 2. Integration Tests (9 тестов)
- **test_01**: Добавление файла → `status=added`
- **test_02**: Изменение файла → `status=updated`
- **test_03**: Удаление файла → `status=deleted`
- **test_04**: Полный жизненный цикл (added → updated → updated → deleted → updated)
- **test_05**: Работа с 3 файлами одновременно
- **test_06**: Фильтрация по расширениям (.txt/.pdf/.docx допустимы, .csv/.jpg/.py игнорируются)
- **test_07**: Переименование с изменением расширения
- **test_08**: 5 быстрых изменений подряд
- **test_09**: Удаление и восстановление с тем же контентом

### 3. Sync Logic Tests (7 тестов)
Проверка таблицы сценариев из документации:
- **test_row1_added**: Удалённый файл со статусом 'added' → 'deleted'
- **test_row1_all**: Удалённые файлы с любым статусом → 'deleted'
- **test_row2_added**: Неизменённый файл 'added' + hash_match → не меняется
- **test_row2_all**: Hash совпадает → статусы не меняются (кроме NULL → 'updated')
- **test_row3_added**: Изменённый файл 'added' + hash_differs → 'updated' с новым hash
- **test_row3_all**: Hash изменился → все статусы → 'updated' с новым hash
- **test_new_file**: Новый файл → 'added'

## Запуск

Автоматически при старте контейнера (если `PRE_LAUNCH_TESTS=1`):
```bash
docker compose up -d filewatcher
```

Результат: `Модулей пройдено: 3/3` (23 теста)
