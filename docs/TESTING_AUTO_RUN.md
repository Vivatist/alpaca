# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

## –û–ø–∏—Å–∞–Ω–∏–µ

Worker –º–æ–∂–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞—Ç—å —Ç–µ—Å—Ç—ã –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã.

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ß–µ—Ä–µ–∑ settings.py (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `settings.py`:

```python
# Testing
RUN_TESTS_ON_START: bool = True  # –í–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
TEST_SUITE: str = "unit"  # "unit", "integration", "all"
```

### –ß–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
RUN_TESTS_ON_START=true TEST_SUITE=unit python worker.py
```

## –¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤

### unit (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è production)
- –ë—ã—Å—Ç—Ä—ã–µ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
- –ù–µ —Ç—Ä–µ–±—É—é—Ç –ë–î –∏–ª–∏ –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- ~1 —Å–µ–∫—É–Ω–¥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –¢–µ—Å—Ç—ã: chunker, parser, embedder

```bash
TEST_SUITE=unit
```

### integration
- –¢—Ä–µ–±—É—é—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
- –ü—Ä–æ–≤–µ—Ä—è—é—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- ~5-10 —Å–µ–∫—É–Ω–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –¢–µ—Å—Ç—ã: worker_integration, worker_pipeline

```bash
TEST_SUITE=integration
```

### all
- –í—Å–µ —Ç–µ—Å—Ç—ã (unit + integration)
- –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã
- ~10-15 —Å–µ–∫—É–Ω–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

```bash
TEST_SUITE=all
```

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### Development —Ä–µ–∂–∏–º (—Å —Ç–µ—Å—Ç–∞–º–∏)
```python
# –í settings.py
RUN_TESTS_ON_START: bool = True
TEST_SUITE: str = "all"
```

```bash
python worker.py
```

### Production —Ä–µ–∂–∏–º (–±–µ–∑ —Ç–µ—Å—Ç–æ–≤)
```python
# –í settings.py (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
RUN_TESTS_ON_START: bool = False
```

```bash
python worker.py
```

### CI/CD (—Ç–æ–ª—å–∫–æ unit-—Ç–µ—Å—Ç—ã)
```bash
RUN_TESTS_ON_START=true TEST_SUITE=unit python worker.py
```

## –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

–ú–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å —Ç–µ—Å—Ç—ã –æ—Ç–¥–µ–ª—å–Ω–æ —á–µ—Ä–µ–∑ runner.py:

```bash
# Unit —Ç–µ—Å—Ç—ã
python tests/runner.py --suite unit

# Integration —Ç–µ—Å—Ç—ã
python tests/runner.py --suite integration

# –í—Å–µ —Ç–µ—Å—Ç—ã
python tests/runner.py --suite all -v

# –° –æ—Å—Ç–∞–Ω–æ–≤–∫–æ–π –Ω–∞ –ø–µ—Ä–≤–æ–π –æ—à–∏–±–∫–µ
python tests/runner.py --suite unit -x
```

## –ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

–ï—Å–ª–∏ —Ç–µ—Å—Ç—ã –ø—Ä–æ–≤–∞–ª–∏–≤–∞—é—Ç—Å—è:
- Worker –≤—ã–≤–æ–¥–∏—Ç –æ—à–∏–±–∫—É –∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è
- Exit code = 1
- –°–æ–æ–±—â–µ–Ω–∏–µ: "–¢–µ—Å—Ç—ã –ø—Ä–æ–≤–∞–ª–∏–ª–∏—Å—å - –≤—ã—Ö–æ–¥ –∏–∑ –ø—Ä–æ–≥—Ä–∞–º–º—ã"

–î–ª—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏:
```bash
RUN_TESTS_ON_START=false python worker.py
```

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

**Production:**
- `RUN_TESTS_ON_START = False` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ settings.py)
- –ó–∞–ø—É—Å–∫–∞–π—Ç–µ —Ç–µ—Å—Ç—ã –æ—Ç–¥–µ–ª—å–Ω–æ –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

**Development:**
- –í settings.py: `RUN_TESTS_ON_START = True`
- `TEST_SUITE = "unit"` –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏

**CI/CD:**
- –ß–µ—Ä–µ–∑ env: `RUN_TESTS_ON_START=true TEST_SUITE=all python worker.py`

**Docker:**
```dockerfile
ENV RUN_TESTS_ON_START=true
ENV TEST_SUITE=unit
CMD ["python", "worker.py"]
```

## –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
============================================================
RUN_TESTS_ON_START=True - –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –ø–µ—Ä–µ–¥ —Å—Ç–∞—Ä—Ç–æ–º...
============================================================
üß™ –ó–∞–ø—É—Å–∫ unit-—Ç–µ—Å—Ç–æ–≤...
=============================================== test session starts ================================================
...
17 passed in 0.78s
‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!
============================================================
–¢–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ - –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
============================================================
Worker started...
```
